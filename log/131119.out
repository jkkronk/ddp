('Under sample factor: ', 4)
FLAIR20201020-125121/jonatank_lat60_ns50_ps28_modalityFLAIR_step100000.ckpt
Read from existing sensmap pattern file
Read from existing u.s. pattern file
xxxxxxxxxxxxxxxxxxx contRec is 
xxxxxxxxxxxxxxxxxxx parfact is 25
---- Defining VAE
>>> lat_dim value: 60
>>> mode is: MRIunproc
2020-10-29 18:00:11.804304: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2020-10-29 18:00:12.007173: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:08:00.0
totalMemory: 10.73GiB freeMemory: 10.57GiB
2020-10-29 18:00:12.007212: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2020-10-29 18:00:12.435441: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-10-29 18:00:12.435482: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2020-10-29 18:00:12.435489: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2020-10-29 18:00:12.435694: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10203 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:08:00.0, compute capability: 7.5)
Initialized parameters
KCT-info: loaded the new model, trained fastmri
KCT-INFO: the gradients: 
Tensor("gradients_2/AddN_3:0", shape=(1250, 784), dtype=float32)
Tensor("gradients_3/Reshape_2_grad/Reshape:0", shape=(1250, 784), dtype=float32)
Tensor("gradients_4/Reshape_2_grad/Reshape:0", shape=(1250, 784), dtype=float32)
_____DIRECT APPROX_____
KCT-INFO: there will be in total 1035 patches.
contRec is 
it no: 0 f_tot= 0 f_lik= 0 TV norm= 2845.6997463960306 f_dc (1e6)= 0.0 |g_lik|= 16222.133316256139 |g_dc|= 13.189990624047814 |g_tv|= 361.86514735957894
NMSE:  0.15720834131493586
it no: 2 f_tot= 0 f_lik= 0 TV norm= 3460.993213679589 f_dc (1e6)= 0.0 |g_lik|= 13322.48686598591 |g_dc|= 6.78366641136069 |g_tv|= 386.35243809716997
NMSE:  0.15233350792824102
it no: 4 f_tot= 0 f_lik= 0 TV norm= 3790.6320361135668 f_dc (1e6)= 0.0 |g_lik|= 13856.921504928143 |g_dc|= 4.220757294182391 |g_tv|= 397.02472694173696
NMSE:  0.15018326012251584
it no: 6 f_tot= 0 f_lik= 0 TV norm= 4039.381374020265 f_dc (1e6)= 0.0 |g_lik|= 12255.839478633472 |g_dc|= 3.0301054789561475 |g_tv|= 403.2509400549874
NMSE:  0.14911293612991158
it no: 8 f_tot= 0 f_lik= 0 TV norm= 4234.765984425634 f_dc (1e6)= 0.0 |g_lik|= 10980.005131563954 |g_dc|= 2.4230133696659006 |g_tv|= 407.5254092915129
NMSE:  0.1485627543712233
it no: 10 f_tot= 0 f_lik= 0 TV norm= 4399.968676953423 f_dc (1e6)= 0.0 |g_lik|= 10133.801154926216 |g_dc|= 2.084344486235535 |g_tv|= 410.7641895879186
NMSE:  0.14815825204102473
it no: 12 f_tot= 0 f_lik= 0 TV norm= 4546.047311983431 f_dc (1e6)= 0.0 |g_lik|= 9468.959142651363 |g_dc|= 1.8402075928429085 |g_tv|= 413.4878434404556
NMSE:  0.14784110396342054
it no: 14 f_tot= 0 f_lik= 0 TV norm= 4679.4289033695595 f_dc (1e6)= 0.0 |g_lik|= 8994.602856087758 |g_dc|= 1.652604699954644 |g_tv|= 416.03204082661534
NMSE:  0.1479173978118243
it no: 16 f_tot= 0 f_lik= 0 TV norm= 4809.15183385247 f_dc (1e6)= 0.0 |g_lik|= 8571.665781816653 |g_dc|= 1.5891500397525806 |g_tv|= 418.51996003598634
NMSE:  0.14788671721597893
it no: 18 f_tot= 0 f_lik= 0 TV norm= 4929.354493163549 f_dc (1e6)= 0.0 |g_lik|= 8231.403848012946 |g_dc|= 1.4682146399535723 |g_tv|= 420.84560629046035
NMSE:  0.14794828505249394
it no: 20 f_tot= 0 f_lik= 0 TV norm= 5043.228028937797 f_dc (1e6)= 0.0 |g_lik|= 7976.091579009589 |g_dc|= 1.378482815469255 |g_tv|= 422.90574330038186
NMSE:  0.14815941259698553
it no: 22 f_tot= 0 f_lik= 0 TV norm= 5154.140656720765 f_dc (1e6)= 0.0 |g_lik|= 7732.418369502993 |g_dc|= 1.3238580183589426 |g_tv|= 424.72949956206577
NMSE:  0.14840062058111547
it no: 24 f_tot= 0 f_lik= 0 TV norm= 5261.137086469074 f_dc (1e6)= 0.0 |g_lik|= 7543.469668201284 |g_dc|= 1.271983946458292 |g_tv|= 426.50736698494376
NMSE:  0.14866490486680095
it no: 26 f_tot= 0 f_lik= 0 TV norm= 5364.244365482651 f_dc (1e6)= 0.0 |g_lik|= 7389.200899677002 |g_dc|= 1.225840588553642 |g_tv|= 428.2018063507808
NMSE:  0.14902088549567652
it no: 28 f_tot= 0 f_lik= 0 TV norm= 5465.4543356293225 f_dc (1e6)= 0.0 |g_lik|= 7203.9013593045765 |g_dc|= 1.1957305785345766 |g_tv|= 429.96782147170416
NMSE:  0.14941218390570107
it no: 30 f_tot= 0 f_lik= 0 TV norm= 5564.052469554681 f_dc (1e6)= 0.0 |g_lik|= 7060.046078943295 |g_dc|= 1.168317285878581 |g_tv|= 431.6129064006322
NMSE:  0.14983354130814452
it no: 32 f_tot= 0 f_lik= 0 TV norm= 5659.999157276478 f_dc (1e6)= 0.0 |g_lik|= 6943.751191923997 |g_dc|= 1.142418224143763 |g_tv|= 433.1427373661755
NMSE:  0.15030497076604946
it no: 34 f_tot= 0 f_lik= 0 TV norm= 5754.43095164441 f_dc (1e6)= 0.0 |g_lik|= 6805.166938670638 |g_dc|= 1.1229969391767358 |g_tv|= 434.60121415679333
NMSE:  0.1507925606352287
it no: 36 f_tot= 0 f_lik= 0 TV norm= 5846.836731789266 f_dc (1e6)= 0.0 |g_lik|= 6723.403594117481 |g_dc|= 1.1012110113388027 |g_tv|= 435.99971663444535
NMSE:  0.15132467977408337
it no: 38 f_tot= 0 f_lik= 0 TV norm= 5938.130960469891 f_dc (1e6)= 0.0 |g_lik|= 6628.564358218483 |g_dc|= 1.085770262357254 |g_tv|= 437.4180285893252
NMSE:  0.15186659537068434
it no: 40 f_tot= 0 f_lik= 0 TV norm= 6026.977142964095 f_dc (1e6)= 0.0 |g_lik|= 6533.643733042916 |g_dc|= 1.0708759409138937 |g_tv|= 438.8031405245133
NMSE:  0.1524519041321175
it no: 42 f_tot= 0 f_lik= 0 TV norm= 6115.079740433757 f_dc (1e6)= 0.0 |g_lik|= 6409.109287049123 |g_dc|= 1.0631701919196046 |g_tv|= 440.1231545925273
NMSE:  0.1530264336795204
it no: 44 f_tot= 0 f_lik= 0 TV norm= 6201.096800968511 f_dc (1e6)= 0.0 |g_lik|= 6332.796150192784 |g_dc|= 1.046513228548798 |g_tv|= 441.43309996239736
NMSE:  0.15363588977458786
it no: 46 f_tot= 0 f_lik= 0 TV norm= 6286.620348507554 f_dc (1e6)= 0.0 |g_lik|= 6250.248012581309 |g_dc|= 1.0387957884557828 |g_tv|= 442.6859630057602
NMSE:  0.1542590254956955
it no: 48 f_tot= 0 f_lik= 0 TV norm= 6371.03322764432 f_dc (1e6)= 0.0 |g_lik|= 6167.331087742976 |g_dc|= 1.0281385346260965 |g_tv|= 443.91687764151254
NMSE:  0.15486091125057344
it no: 50 f_tot= 0 f_lik= 0 TV norm= 6453.9269941702705 f_dc (1e6)= 0.0 |g_lik|= 6086.471224979442 |g_dc|= 1.009493599951414 |g_tv|= 445.09814926601723
NMSE:  0.15548538513103058
it no: 52 f_tot= 0 f_lik= 0 TV norm= 6535.953207972139 f_dc (1e6)= 0.0 |g_lik|= 5996.175119690249 |g_dc|= 0.9960942767335793 |g_tv|= 446.25205239642656
NMSE:  0.15609736725985374
it no: 54 f_tot= 0 f_lik= 0 TV norm= 6616.18876697528 f_dc (1e6)= 0.0 |g_lik|= 5941.920033154369 |g_dc|= 0.9812836393892828 |g_tv|= 447.33817589219007
NMSE:  0.1567368794436735
it no: 56 f_tot= 0 f_lik= 0 TV norm= 6695.977303992954 f_dc (1e6)= 0.0 |g_lik|= 5886.79840611665 |g_dc|= 0.9716041842315313 |g_tv|= 448.38494458626707
NMSE:  0.15741071767038728
it no: 58 f_tot= 0 f_lik= 0 TV norm= 6775.43952249101 f_dc (1e6)= 0.0 |g_lik|= 5824.479205775903 |g_dc|= 0.968010427000888 |g_tv|= 449.41146486742036
NMSE:  0.15811332598084402
it no: 60 f_tot= 0 f_lik= 0 TV norm= 6854.063504452188 f_dc (1e6)= 0.0 |g_lik|= 5778.42689109797 |g_dc|= 0.9655097959058646 |g_tv|= 450.4544555591318
NMSE:  0.1588105661710552
it no: 62 f_tot= 0 f_lik= 0 TV norm= 6932.022698340829 f_dc (1e6)= 0.0 |g_lik|= 5678.771876470544 |g_dc|= 0.9617969780585144 |g_tv|= 451.4850918350266
NMSE:  0.15945992064756667
it no: 64 f_tot= 0 f_lik= 0 TV norm= 7008.247176049324 f_dc (1e6)= 0.0 |g_lik|= 5640.9780263779685 |g_dc|= 0.9464521764487484 |g_tv|= 452.51197263131155
NMSE:  0.16014781018036392
it no: 66 f_tot= 0 f_lik= 0 TV norm= 7084.540225179407 f_dc (1e6)= 0.0 |g_lik|= 5565.110930667313 |g_dc|= 0.937855335764615 |g_tv|= 453.4913517439917
NMSE:  0.1607703088721552
it no: 68 f_tot= 0 f_lik= 0 TV norm= 7159.001621903418 f_dc (1e6)= 0.0 |g_lik|= 5519.411548695632 |g_dc|= 0.9193258521730883 |g_tv|= 454.4719093266856
NMSE:  0.1614435300322166
it no: 70 f_tot= 0 f_lik= 0 TV norm= 7232.985043347763 f_dc (1e6)= 0.0 |g_lik|= 5472.07096913214 |g_dc|= 0.9113530850997089 |g_tv|= 455.4235171861294
NMSE:  0.1620950604708226
it no: 72 f_tot= 0 f_lik= 0 TV norm= 7306.519884584545 f_dc (1e6)= 0.0 |g_lik|= 5422.712332112542 |g_dc|= 0.8991329046205848 |g_tv|= 456.3387773273168
NMSE:  0.16278385518896618
it no: 74 f_tot= 0 f_lik= 0 TV norm= 7379.2752514104495 f_dc (1e6)= 0.0 |g_lik|= 5389.629781479631 |g_dc|= 0.8942121729630316 |g_tv|= 457.2536420101186
NMSE:  0.16348621147128112
it no: 76 f_tot= 0 f_lik= 0 TV norm= 7451.8847993949685 f_dc (1e6)= 0.0 |g_lik|= 5339.912076878965 |g_dc|= 0.8896064924041122 |g_tv|= 458.1230313861919
NMSE:  0.1641614355051473
it no: 78 f_tot= 0 f_lik= 0 TV norm= 7523.673562693757 f_dc (1e6)= 0.0 |g_lik|= 5309.187969644507 |g_dc|= 0.8797158985702588 |g_tv|= 458.9726338830099
NMSE:  0.1648637610296557
it no: 80 f_tot= 0 f_lik= 0 TV norm= 7594.963594733793 f_dc (1e6)= 0.0 |g_lik|= 5260.449801885221 |g_dc|= 0.877546908875936 |g_tv|= 459.79926860933466
NMSE:  0.1655235150775777
it no: 82 f_tot= 0 f_lik= 0 TV norm= 7665.317130567513 f_dc (1e6)= 0.0 |g_lik|= 5235.654563885026 |g_dc|= 0.8649954512264975 |g_tv|= 460.618879451924
NMSE:  0.16621901005254336
it no: 84 f_tot= 0 f_lik= 0 TV norm= 7735.683954407698 f_dc (1e6)= 0.0 |g_lik|= 5214.748282845695 |g_dc|= 0.8596873600654219 |g_tv|= 461.400530430786
NMSE:  0.16689772963729418
it no: 86 f_tot= 0 f_lik= 0 TV norm= 7805.459442587822 f_dc (1e6)= 0.0 |g_lik|= 5174.307350280459 |g_dc|= 0.8518576801107727 |g_tv|= 462.2120831134129
NMSE:  0.16768089324084748
it no: 88 f_tot= 0 f_lik= 0 TV norm= 7875.481749977725 f_dc (1e6)= 0.0 |g_lik|= 5093.501765745834 |g_dc|= 0.8625462100636001 |g_tv|= 462.9806964874848
NMSE:  0.16833118309018888
it no: 90 f_tot= 0 f_lik= 0 TV norm= 7943.727199435457 f_dc (1e6)= 0.0 |g_lik|= 5084.474039057999 |g_dc|= 0.843910536989492 |g_tv|= 463.7441671826905
NMSE:  0.16900027376674503
it no: 92 f_tot= 0 f_lik= 0 TV norm= 8011.915748262635 f_dc (1e6)= 0.0 |g_lik|= 5055.5272629816045 |g_dc|= 0.8343157497209059 |g_tv|= 464.4770176136049
NMSE:  0.1696835027363767
it no: 94 f_tot= 0 f_lik= 0 TV norm= 8079.809665305594 f_dc (1e6)= 0.0 |g_lik|= 5042.343797365883 |g_dc|= 0.828352304857454 |g_tv|= 465.20133606090315
NMSE:  0.1704180169148193
it no: 96 f_tot= 0 f_lik= 0 TV norm= 8147.871106761386 f_dc (1e6)= 0.0 |g_lik|= 5008.524803167378 |g_dc|= 0.8292773168328307 |g_tv|= 465.94089969250575
NMSE:  0.171120702219596
('<<RECONSTRUCTION DONE>>', '     Subject: ', 'file_brain_AXFLAIR_200_6002462.h5', '     NMSE = ', 0.16882391090993648, '      RMS = ', 0.08143883300407742, '     SSIM = ', 0.4599162580818233)
